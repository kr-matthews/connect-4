(this["webpackJsonpconnect-4"]=this["webpackJsonpconnect-4"]||[]).push([[0],{22:function(e,n,r){},27:function(e,n,r){},28:function(e,n,r){"use strict";r.r(n);var t=r(1),o=r.n(t),c=r(10),a=r.n(c),l=r(2),i=r(0);var s=function(e){var n=e.children;return Object(i.jsx)("div",{children:n.map((function(e,n){return Object(i.jsx)("div",{children:e},n)}))})};var u=function(e){var n=e.children;return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("h2",{children:"Lobby"}),Object(i.jsx)("p",{children:"Welcome to the Connect 4 lobby. Here, you can create or join a room. Rooms are where you can play a game of Connect 4, and can fit up to 2 players."}),n]})};var d=function(e){var n=e.name,r=e.setName,o=Object(t.useState)(!1),c=Object(l.a)(o,2),a=c[0],s=c[1];return Object(i.jsxs)(i.Fragment,{children:["Your name is"," ",a?Object(i.jsx)("input",{type:"text",value:n,placeholder:"Name",onChange:function(e){r(e.target.value.trim())},onKeyDown:function(e){"Enter"===e.key&&(""===n&&r("Nameless"),s(!1))},onBlur:function(e){""===n&&r("Nameless"),s(!1)}}):Object(i.jsx)("span",{onClick:function(){s(!0)},children:n}),"."]})};var j=function(e){var n=e.colour,r=e.setColour;return Object(i.jsxs)(i.Fragment,{children:["Your piece colour is"," ",Object(i.jsx)("input",{type:"color",value:n,onChange:function(e){r(e.target.value)}}),"."]})};var h=function(e){var n=e.themeType,r=e.toggleTheme;return Object(i.jsxs)(i.Fragment,{children:["You're using the ",Object(i.jsx)("span",{onClick:r,children:n})," theme."]})};var b=function(e){var n=e.createRoomHandler;return Object(i.jsxs)("div",{children:[Object(i.jsx)("h3",{children:"Create a Room"}),Object(i.jsx)("p",{children:"Once created, you will be given a room code which you can share with a friend to join."}),Object(i.jsx)("button",{onClick:n,children:"Create"})]})};var f=function(e){var n=e.joinRoomHandler,r=Object(t.useState)(""),o=Object(l.a)(r,2),c=o[0],a=o[1];return Object(i.jsxs)("div",{children:[Object(i.jsx)("h3",{children:"Join a Room"}),Object(i.jsx)("p",{children:"If someone else has given you a code, use that code to join their room."}),Object(i.jsxs)("form",{children:[Object(i.jsx)("input",{type:"text",value:c,placeholder:"enter room code",onChange:function(e){return function(e){a(e.target.value.toUpperCase().trim())}(e)}}),Object(i.jsx)("button",{onClick:function(){return n(c)},children:"Join"})]})]})};var O=function(e){var n=e.isOwner,r=e.opponent,t=e.restartMethod,o=e.resultHistory,c=e.kickOpponentHandler,a=e.closeRoomHandler,l=e.leaveRoomHandler;return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("div",{children:function(){switch(t){case"random":return"The first player of a new game is selected randomly.";case"alternate":return"Players alternate playing first in a new game.";default:return"The "+t+" of a game will go first for the next game. In the event of a draw, the same player will go first."}}()}),r?Object(i.jsxs)("div",{children:["You are playing against"," ",Object(i.jsx)("span",{style:{color:r.colour},children:r.name}),"."]}):Object(i.jsx)("div",{children:"Waiting for an opponent to join the room."}),r&&Object(i.jsxs)("div",{children:[Object(i.jsxs)("span",{children:["Wins: ",o.wins]}),Object(i.jsxs)("span",{children:["Draws: ",o.draws]}),Object(i.jsxs)("span",{children:["Loses: ",o.loses]})]}),Object(i.jsxs)("div",{children:[n?Object(i.jsx)("button",{onClick:a,children:"Close Room"}):Object(i.jsx)("button",{onClick:l,children:"Leave Room"}),n&&r&&Object(i.jsx)("button",{onClick:c,children:"Kick Opponent"})]})]})};var p=function(e){var n=e.children;return Object(i.jsx)(i.Fragment,{children:n})};r(22);function g(e){var n=e.row,r=(e.viewer,e.isViewersTurn),t=e.moveHandler,o=e.colours,c=n.map((function(e,n){var c=e.player,a=e.isHighlight,l=e.colIsOpen;return Object(i.jsx)(m,{clickHandler:function(){return t(n)},colour:o[c],isHighlight:a,isClickable:r&&l},n)}));return Object(i.jsx)("tr",{children:c})}function m(e){var n=e.clickHandler,r=e.colour,o=e.isHighlight,c=e.isClickable,a=Object(t.useContext)(W),l=a.background,s=r||l,u={backgroundColor:s,borderColor:o?l:s},d=c?"clickable cell":"cell",j={borderColor:a.foreground};return Object(i.jsx)("td",{className:d,style:j,onClick:n,children:Object(i.jsx)("span",{className:"piece",style:u})})}var v=function(e){for(var n=e.viewer,r=e.board,o=e.isViewersTurn,c=e.colours,a=e.moveHandler,l=Object(t.useContext)(W).foreground,s=[],u=r.length-1;u>-1;u--)s.push(Object(i.jsx)(g,{row:r[u],viewer:n,isViewersTurn:o,moveHandler:a,colours:c},u));return Object(i.jsx)("table",{className:"board",style:{backgroundColor:l},children:Object(i.jsx)("tbody",{children:s})})};var w=function(e){var n=e.viewer,r=e.isOwner,t=e.gameStatus,o=e.winner,c=e.toPlayNext,a=e.forfeitHandler,l=e.newGameHandler;return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("p",{children:function(){switch(t){case"won":return o===n?"Congratulations, you won!":"You lost.";case"forfeit":return o===n?"Your opponent has forfeit the game -- you win.":"You lost by forfeiting the game.";case"draw":return"It's a draw.";case"ongoing":return n===c?"It's your turn to drop a piece.":"Waiting for your opponent to play.";default:return"Something has gone wrong. Apologies."}}()}),"ongoing"===t?Object(i.jsx)("button",{onClick:function(){return a(n)},children:"Forfeit"}):r&&Object(i.jsx)("button",{onClick:l,children:"New Game"})]})},y=r(16),x=r(8),k=[[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]];function H(e,n,r){for(var t=[],o=0;o<e;o++){for(var c=[],a=0;a<n;a++)c.push("empty"===r?{}:r);t.push(c)}return t}function C(e,n){for(var r=e.length,t=[e[0].length,e[0][0].length],o=t[0],c=t[1],a=H(o,c,"empty"),l=0;l<o;l++)for(var i=0;i<c;i++){a[l][i]={};for(var s=0;s<r;s++)a[l][i][n[s]]=e[s][l][i]}return a}function R(e,n){var r=Object(x.a)(e);switch(n.type){case"reset":return[];case"addMove":var t=n.player,o=n.row,c=n.col;return r.push({player:t,row:o,col:c}),r;case"undo":return e===[]?e:(r.pop(),r);default:return console.log("moveHistoryReducer switch didn't match any case"),e}}function N(e,n){var r=Object(x.a)(e);switch(n.type){case"reset":return H(n.rows,n.cols,null);case"placePiece":return r[n.row][n.col]=n.player,r;case"undo":return r[n.row][n.col]=null,r;default:return console.log("peicesReducer switch didn't match any case"),e}}function S(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:7,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,c=Object(t.useState)(e),a=Object(l.a)(c,2),i=a[0],s=a[1],u=Object(t.useState)(null),d=Object(l.a)(u,2),j=d[0],h=d[1],b=Object(t.useReducer)(R,[]),f=Object(l.a)(b,2),O=f[0],p=f[1],g=Object(t.useReducer)(N,H(n,r,null)),m=Object(l.a)(g,2),v=m[0],w=m[1],y=Y()?"won":G()?"draw":"ongoing",x=null!==j?"forfeit":y,S="forfeit"===x?1-j:"won"!==x?null:O[O.length-1].player,F=E(),P=J(),I=C([v,F,P],["player","isHighlight","colIsOpen"]),M="ongoing"!==x?null:0===O.length?i:1-O[O.length-1].player;function T(e){for(var r=0;r<n;r++)if(null===v[r][e])return r;return null}function G(){for(var e=0;e<r;e++)if(null===v[n-1][e])return!1;return!0}function Y(){if(O.length<2*o-1)return!1;for(var e=O[O.length-1],n=e.player,r=e.row,t=e.col,c=0;c<k.length;c++)for(var a=Object(l.a)(k[c],2),i=a[0],s=a[1],u=-3;u<1;u++)if(W(n,r+u*i,t+u*s,i,s))return!0;return!1}function E(){var e=H(n,r,!1);if(O.length<2*o-1)return e;for(var t=O[O.length-1],c=t.player,a=t.row,i=t.col,s=0;s<k.length;s++)for(var u=Object(l.a)(k[s],2),d=u[0],j=u[1],h=1-o;h<1;h++)if(W(c,a+h*d,i+h*j,d,j))for(var b=h;b<h+o;b++)e[a+b*d][i+b*j]=!0;return e}function J(){for(var e=H(n,r),t=0;t<r;t++)for(var o=null===v[n-1][t],c=0;c<n;c++)e[c][t]=o;return e}function W(e,t,c,a,l){for(var i=0;i<o;i++){var s=t+i*a,u=c+i*l;if(0>s||s>=n||0>u||u>=r||v[s][u]!==e)return!1}return!0}function V(e){s(e),h(null),p({type:"reset"}),w({type:"reset",rows:n,cols:r})}function B(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M,r=T(e);"ongoing"===x&&n===M&&null!==r&&(p({type:"addMove",player:n,row:r,col:e}),w({type:"placePiece",player:n,row:r,col:e}))}function L(e){h(e)}return{board:I,gameStatus:x,toPlayNext:M,winner:S,resetGame:V,placePiece:B,forfeit:L}}function F(e,n){if("reset"===n.type)return P;var r=Object(y.a)({},e);return r[n.type+"s"]+=1,r}var P={wins:0,draws:0,loses:0};var I=function(e){var n=e.player,r=e.isOwner,o=(e.roomId,e.restartMethod),c=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.floor(2*Math.random()),r={name:"Bob",colour:"red"},o=null===r?1:2,c=Object(t.useReducer)(F,P),a=Object(l.a)(c,2),i=a[0],s=a[1],u=S(n),d=u.board,j=u.gameStatus,h=u.toPlayNext,b=u.winner,f=u.resetGame,O=u.placePiece,p=u.forfeit,g=Object(t.useState)(n),m=Object(l.a)(g,2),v=m[0],w=m[1];function y(n){var r=null;switch(e){case"random":r=Math.floor(2*Math.random());break;case"alternate":r=1-v;break;case"loser":r="draw"===n?v:1-b;break;case"winner":r="draw"===n?v:b;break;default:console.log("New Game click handler didn't match any case."),r=0}f(r),w(r)}return Object(t.useEffect)((function(){switch(j){case"won":case"forfeit":0===b&&s({type:"win"}),0===b&&console.log("win sound"),1===b&&s({type:"lose"}),1===b&&console.log("lose sound");break;case"draw":s({type:"draw"}),console.log("draw sound")}}),[j,b]),Object(t.useEffect)((function(){1===o&&s({type:"reset"})}),[o]),Object(t.useEffect)((function(){1===o?console.log("Opponent left sound"):console.log("Opponent joined sound")}),[o]),Object(t.useEffect)((function(){0===h&&console.log("Your turn sound")}),[h]),{opponent:r,resultHistory:i,board:d,gameStatus:j,winner:b,toPlayNext:h,moveHandler:O,forfeitHandler:p,newGameHandler:y,kickOpponentHandler:null,closeRoomHandler:null,leaveRoomHandler:null}}(o),a=c.opponent,s=c.resultHistory,u=c.board,d=c.gameStatus,j=c.winner,h=c.toPlayNext,b=c.moveHandler,f=c.forfeitHandler,g=c.newGameHandler,m=c.kickOpponentHandler,y=c.closeRoomHandler,x=c.leaveRoomHandler;return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("h2",{children:"Room"}),Object(i.jsx)(O,{isOwner:r,opponent:a,restartMethod:o,resultHistory:s,kickOpponentHandler:m,closeRoomHandler:y,leaveRoomHandler:x}),a&&Object(i.jsxs)(p,{children:[Object(i.jsx)(v,{viewer:0,board:u,isViewersTurn:0===h,colours:[n.colour,a.colour],moveHandler:b}),Object(i.jsx)(w,{viewer:0,isOwner:r,gameStatus:d,winner:j,toPlayNext:h,forfeitHandler:f,newGameHandler:g})]})]})};function M(e,n){var r=JSON.parse(localStorage.getItem(e)),o=Object(t.useState)(r||n),c=Object(l.a)(o,2),a=c[0],i=c[1];return[a,function(n){i(n),localStorage.setItem(e,JSON.stringify(n))}]}var T,G=r(11),Y=r(12),E=Object(Y.a)(T||(T=Object(G.a)(["\n  body {\n      background: ",";\n      color: ",";\n      transition: all 0.75s ease-in;\n      transition-property: background, color\n    }\n  "])),(function(e){return e.theme.background}),(function(e){return e.theme.foreground})),J={light:{type:"light",background:"#F5F5F5",foreground:"#121212"},dark:{type:"dark",background:"#121212",foreground:"#F5F5F5"}},W=Object(t.createContext)(J.light);var V=function(){var e=M("name","Nameless"),n=Object(l.a)(e,2),r=n[0],t=n[1],o=M("colour","#0000FF"),c=Object(l.a)(o,2),a=c[0],O=c[1],p=M("theme",J.light),g=Object(l.a)(p,2),m=g[0],v=g[1];return Object(i.jsxs)(W.Provider,{value:m,children:[Object(i.jsx)(E,{theme:m}),Object(i.jsxs)(s,{children:[Object(i.jsx)(d,{name:r,setName:t}),Object(i.jsx)(j,{colour:a,setColour:O}),Object(i.jsx)(h,{themeType:m.type,toggleTheme:function(){v("light"===m.type?J.dark:J.light)}})]}),Object(i.jsx)("h1",{children:"Connect 4 [WIP]"}),Object(i.jsxs)(u,{children:[Object(i.jsx)(b,{createRoomHandler:null}),Object(i.jsx)(f,{joinRoomHandler:null})]}),Object(i.jsx)(I,{player:{name:r,colour:a},isOwner:!0,roomId:"2134676543",restartMethod:"alternate",closeRoomHandler:null})]})};r(27);a.a.render(Object(i.jsx)(o.a.StrictMode,{children:Object(i.jsx)(V,{})}),document.getElementById("root"))}},[[28,1,2]]]);
//# sourceMappingURL=main.68dd9ecc.chunk.js.map