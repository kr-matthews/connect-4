(this["webpackJsonpconnect-4"]=this["webpackJsonpconnect-4"]||[]).push([[0],{24:function(e,t,n){},27:function(e,t,n){},28:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),c=n(13),a=n.n(c),s=n(5),i=n(2),u=n(14),l=n.n(u),b=(n(24),n(0));var d=function(e){var t=e.children;return Object(b.jsx)("div",{className:"header",children:t})};var j=function(e){var t=e.children,n=e.self;return Object(b.jsxs)("div",{className:"playerInfo headerBlock "+(n?"self":"opponent"),children:[Object(b.jsx)("h3",{children:n?"You":"Opponent"}),t]})};var p=function(e){var t=e.editable,n=e.name,o=e.setName,c=Object(r.useState)(!1),a=Object(i.a)(c,2),s=a[0],u=a[1];function l(){var e=""===n?"Nameless":n.trim();o(e),u(!1)}return Object(b.jsx)("div",{children:s?Object(b.jsx)("input",{autoFocus:!0,type:"text",value:n,placeholder:"Name",onChange:function(e){e.target.value.length<=20&&o(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&l()},onBlur:l}):t?Object(b.jsx)("button",{onClick:function(){u(!0)},children:n}):n})};var h=function(e){var t=e.editable,n=e.colour,r=e.setColour;return Object(b.jsxs)("div",{children:["Colour:"," ",t?Object(b.jsx)("input",{type:"color",value:n,onChange:function(e){var t=e.target.value;r(t)}}):Object(b.jsx)("input",{type:"color",disabled:!0,value:n})]})};var f=function(e){var t=e.children;return Object(b.jsxs)("div",{className:"options headerBlock",children:[Object(b.jsx)("h3",{children:"Options"}),t]})};var m=function(e){var t=e.usingGradient,n=e.setUsingGradient;return Object(b.jsxs)("div",{children:["There's a gradient on"," ",Object(b.jsxs)("select",{value:t.toString(),onChange:function(e){n(e.target.value)},children:[Object(b.jsx)("option",{value:"all",children:"all"}),Object(b.jsx)("option",{value:"my",children:"my"}),Object(b.jsx)("option",{value:"their",children:"their"}),Object(b.jsx)("option",{value:"no",children:"no"})]})," ","pieces."]})};var O=function(e){var t=e.themeType,n=e.toggleTheme;return Object(b.jsxs)("div",{children:["You're using the ",Object(b.jsx)("button",{onClick:n,children:t})," theme."]})};var g=function(e){var t=e.soundIsOn,n=e.toggleSound;return Object(b.jsxs)("div",{children:["Sound is ",Object(b.jsx)("button",{onClick:n,children:t?"on":"off"}),"."]})},v=n(3),y=n.n(v),x=n(4);var w=function(e){var t=e.createRoom,n=Object(r.useState)("alternate"),o=Object(i.a)(n,2),c=o[0],a=o[1];function s(e){a(e.target.value)}return Object(b.jsxs)("div",{children:[Object(b.jsx)("h3",{children:"Create an Online Room"}),Object(b.jsx)("p",{children:"Once created, you will be given a room code which you can share with a friend to join."}),Object(b.jsx)("p",{children:"The first player of the first game will be selected randomly. Select who will go first in subsequent games."}),Object(b.jsxs)("form",{children:[["Alternate","Loser","Winner","Random"].map((function(e){return Object(b.jsxs)("label",{children:[Object(b.jsx)("input",{type:"radio",value:e.toLowerCase(),checked:c===e.toLowerCase(),onChange:s}),e]},e)})),Object(b.jsx)("button",{onClick:function(e){e.preventDefault(),t(c)},children:"Create Room"})]})]})};var k=function(e){var t=e.joinRoom,n=Object(r.useState)(""),o=Object(i.a)(n,2),c=o[0],a=o[1];return Object(b.jsxs)("div",{children:[Object(b.jsx)("h3",{children:"Join an Online Room"}),Object(b.jsx)("p",{children:"If someone else has given you a room code, use that code to join their room. Room codes are 4 characters."}),Object(b.jsxs)("form",{children:[Object(b.jsx)("input",{type:"text",value:c,placeholder:"enter room code",onChange:function(e){a(e.target.value.toUpperCase().trim())}}),Object(b.jsx)("button",{onClick:function(e){e.preventDefault(),c&&t(c)},children:"Join Room"})]})]})};var A=function(e){var t=e.playLocally;return Object(b.jsxs)("div",{children:[Object(b.jsx)("h3",{children:"Local Multi-Player"}),Object(b.jsx)("p",{children:"If you have someone using the same screen as you, play against them locally."}),Object(b.jsx)("form",{children:Object(b.jsx)("button",{onClick:function(e){e.preventDefault(),t()},children:"Play Locally"})})]})};var C=function(e){var t=e.playComputer;return Object(b.jsxs)("div",{children:[Object(b.jsx)("h3",{children:"Play Computer"}),Object(b.jsx)("p",{children:"If you don't have anyone to play against, there is a computer opponent available."}),Object(b.jsx)("form",{children:Object(b.jsx)("button",{onClick:function(e){e.preventDefault(),t()},children:"Play Computer"})})]})},M=["#FF0000","#FF69B4","#FF8C00","#FFD700","#FF00FF","#228B22","#0000FF","#8B4513","#C0C0C0"];function R(){return M[Math.floor(Math.random()*M.length)]}function N(e){var t=function(e,t,n){var r=Math.min(e,t,n),o=Math.max(e,t,n),c=o-r,a=o+r,s=(o+r)/2;if(0===c)return[0,0,s];var i=((o-e)/6+c/2)/c,u=((o-t)/6+c/2)/c,l=((o-n)/6+c/2)/c,b=e===o?l-u:t===o?1/3+i-l:n===o?2/3+u-i:"N/A";return[b<0?b+1:b>1?b-1:b,s<.5?c/a:c/(2-a),s]}(parseInt(e.substring(1,3),16)/255,parseInt(e.substring(3,5),16)/255,parseInt(e.substring(5,7),16)/255),n=Object(i.a)(t,3),r=n[0],o=function(e,t,n){if(0===t)return[n,n,n];var r=n<.5?n*(1+t):n+t-t*n,o=2*n-r;return[S(o,r,e+1/3),S(o,r,e),S(o,r,e-1/3)]}(r>.5?r-.5:r+.5,n[1],1-n[2]),c=Object(i.a)(o,3),a=c[0],s=c[1],u=c[2];return"#"+I(Math.round(255*a).toString(16)).toUpperCase()+I(Math.round(255*s).toString(16)).toUpperCase()+I(Math.round(255*u).toString(16)).toUpperCase()}function I(e){return 2===e.length?e:"0"+e}function S(e,t,n){var r=n<0?n+1:n>1?n-1:n;return 6*r<1?e+6*(t-e)*r:2*r<1?t:3*r<2?e+6*(2/3-r)*(t-e):e}var T="Could not successfully check room occupancy.\nMay not be connected to the network.";var E=function(e){var t=e.setOpponent,n=e.setPlayType,r=e.setRoomCode,o=e.setIsOwner,c=e.setRestartMethod,a=e.pubnub;function s(){return(s=Object(x.a)(y.a.mark((function e(t){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.hereNow({channels:[t]});case 3:return n=e.sent,e.abrupt("return",n.totalOccupancy);case 7:throw e.prev=7,e.t0=e.catch(0),alert(T),console.error("Couldn't get room occupancy.",e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}var i=function(e,t,n,r,o,c){function a(){return s.apply(this,arguments)}function s(){return(s=Object(x.a)(y.a.mark((function e(){var t,n,r,o;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t="ABCDEFGHJKMNPQRSTUVXYZ23456789",n="",r=-1,e.prev=3;case 4:for(n="",o=0;o<4;o++)n+=t.charAt(Math.floor(Math.random()*t.length));return e.next=8,c(n);case 8:r=e.sent;case 9:if(r>0){e.next=4;break}case 10:return e.abrupt("return",n);case 13:throw e.prev=13,e.t0=e.catch(3),console.error("Couldn't generate room code.",e.t0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[3,13]])})))).apply(this,arguments)}function i(){return(i=Object(x.a)(y.a.mark((function e(c){var s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a();case 3:s=e.sent,r(!0),o(c),n(s),t("online"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("Couldn't create room.",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function u(){return(u=Object(x.a)(y.a.mark((function e(a){var s;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c(a);case 3:0===(s=e.sent)?alert("No room with code "+a+" currently exists."):1===s?(r(!1),o(null),n(a),t("online")):alert("The room with code "+a+" already has two players."),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Couldn't join room.",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}return{createRoom:function(e){return i.apply(this,arguments)},joinRoom:function(e){return u.apply(this,arguments)},playLocally:function(){e({name:"Player II",colour:R()}),t("local")},playComputer:function(){e({name:"Computron 40 5000",colour:R()}),t("computer")}}}(t,n,r,o,c,(function(e){return s.apply(this,arguments)})),u=i.createRoom,l=i.joinRoom,d=i.playLocally,j=i.playComputer;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h2",{children:"Lobby"}),Object(b.jsx)("p",{children:"Welcome to the Connect 4 lobby. Here, you can play a friend remotely by creating or joining a room, or you can play locally against a friend or the computer. Rooms can fit up to 2 players."}),Object(b.jsx)(w,{createRoom:u}),Object(b.jsx)(k,{joinRoom:l}),Object(b.jsx)(A,{playLocally:d}),Object(b.jsx)(C,{playComputer:j})]})};var F=function(e){var t=e.resultHistory,n=e.headings;return Object(b.jsxs)("div",{children:[Object(b.jsxs)("span",{children:[n[0],": ",t.wins," --"," "]}),Object(b.jsxs)("span",{children:[n[1],": ",t.draws," --"," "]}),Object(b.jsxs)("span",{children:[n[2],": ",t.loses]})]})};var G=function(e){var t=e.roomCode,n=e.isOwner,r=e.hasOpponent,o=e.restartMethod,c=e.resultHistory,a=e.kickOpponent,s=e.closeRoom,i=e.leaveRoom,u="In this room, "+("random"===o?"the first player of a new game is selected randomly.":"alternate"===o?"players alternate playing first in a new game.":"the "+o+" of a game will go first for the next game. In the event of a draw, the same player will go first."),l=function(){var e=Object(x.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.clipboard.writeText(t);case 2:alert("Room code "+t+" copied to clipboard.");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(b.jsxs)(b.Fragment,{children:[r?n?Object(b.jsx)("div",{children:"You created and are in control of this room."}):Object(b.jsx)("div",{children:"Your opponent created and has control of this room."}):n?Object(b.jsxs)("div",{children:["Waiting for an opponent to join your room. Share your room code"," ",Object(b.jsx)("button",{onClick:l,children:t})," with a friend."]}):Object(b.jsxs)("div",{children:["Waiting for opponent information to be fetched. If this message persists, then something has gone wrong. The room code is ",t,"."]}),o&&Object(b.jsx)("div",{children:u}),Object(b.jsxs)("div",{children:[n?Object(b.jsx)("button",{onClick:s,children:"Close Room"}):Object(b.jsx)("button",{onClick:i,children:"Leave Room"}),n&&r&&Object(b.jsx)("button",{onClick:a,children:"Kick Opponent"})]}),r&&Object(b.jsx)(F,{resultHistory:c,headings:["Wins","Draws","Loses"]})]})};n(27);function J(e){var t=e.row,n=e.viewer,o=e.isViewersTurn,c=e.makeMove,a=e.colours,s=Object(r.useContext)(ke),i=t.map((function(e,t){var r=e.player,i=e.isHighlight,u=e.colIsOpen;return Object(b.jsx)(B,{clickHandler:function(){return c(t,n)},colour:a[r],useGradient:null!==r&&("all"===s||"my"===s&&0===r||"their"===s&&1===r),isHighlight:i,isClickable:o&&u},t)}));return Object(b.jsx)("tr",{children:i})}function B(e){var t=e.clickHandler,n=e.colour,o=e.useGradient,c=e.isHighlight,a=e.isClickable,s=Object(r.useContext)(Ae),i=s.background,u=s.foreground,l=n||i,d=c?N(l):l,j={backgroundColor:l,borderColor:d},p={borderColor:d,backgroundImage:"radial-gradient("+l+","+l+"70)"},h=a?"clickable cell":"cell",f={borderColor:u};return Object(b.jsx)("td",{className:h,style:f,onClick:t,children:Object(b.jsx)("span",{className:"piece",style:o?p:j})})}var Z=function(e){for(var t=e.viewer,n=e.board,o=e.isViewersTurn,c=e.colours,a=e.makeMove,s=Object(r.useContext)(Ae).foreground,i=[],u=n.length-1;u>-1;u--)i.push(Object(b.jsx)(J,{row:n[u],viewer:t,isViewersTurn:o,makeMove:a,colours:c},u));return Object(b.jsx)("table",{className:"board",style:{backgroundColor:s},children:Object(b.jsx)("tbody",{children:i})})};var D=function(e){var t=e.viewer,n=e.isOwner,r=e.gameStatus,o=e.winner,c=e.toPlayNext,a=e.forfeit,s=e.startNewGame,i=e.hasChoice;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("p",{children:function(){switch(r){case"won":return o===t?"Congratulations, you won!":"You lost.";case"forfeit":return o===t?"Your opponent has forfeit the game -- you win.":"You lost by forfeiting the game.";case"draw":return"It's a draw.";case"ongoing":return t===c?"It's your turn to drop a piece.":"Waiting for your opponent to play.";case"waiting":return"The game has not started yet.";default:return console.error("Error: ",r),"Something has gone wrong. Apologies."}}()}),"ongoing"===r?Object(b.jsx)("button",{onClick:a,children:"Forfeit"}):n?i?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{onClick:function(){return s(t)},children:"New Game: Go First"}),Object(b.jsx)("button",{onClick:function(){return s(1-t)},children:"New Game: Go Second"})]}):Object(b.jsx)("button",{onClick:s,children:"New Game"}):Object(b.jsxs)("p",{children:["Waiting for your opponent to start"," ","waiting"===r?"the ":"a new ","game."]})]})},P=n(7),W=[[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]];function H(e,t,n){for(var r=[],o=0;o<e;o++){for(var c=[],a=0;a<t;a++)c.push("empty"===n?{}:n);r.push(c)}return r}function U(e,t){for(var n=e.length,r=[e[0].length,e[0][0].length],o=r[0],c=r[1],a=H(o,c,"empty"),s=0;s<o;s++)for(var i=0;i<c;i++){a[s][i]={};for(var u=0;u<n;u++)a[s][i][t[u]]=e[u][s][i]}return a}function Y(e,t){var n=Object(P.a)(e);switch(t.type){case"reset":return[];case"addMove":var r=t.player,o=t.row,c=t.col;return n.push({player:r,row:o,col:c}),n;case"undo":return e===[]?e:(n.pop(),n);default:return console.error("moveHistoryReducer didn't match any case.",t),e}}function L(e,t){var n=Object(P.a)(e);switch(t.type){case"reset":return H(t.rows,t.cols,null);case"placePiece":return n[t.row][t.col]=t.player,n;case"undo":return n[t.row][t.col]=null,n;default:return console.error("peicesReducer didn't match any case.",t),e}}function Q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,o=Object(r.useState)(null),c=Object(i.a)(o,2),a=c[0],s=c[1],u=Object(r.useState)(!0),l=Object(i.a)(u,2),b=l[0],d=l[1],j=Object(r.useState)(null),p=Object(i.a)(j,2),h=p[0],f=p[1],m=Object(r.useReducer)(Y,[]),O=Object(i.a)(m,2),g=O[0],v=O[1],y=Object(r.useReducer)(L,H(e,t,null)),x=Object(i.a)(y,2),w=x[0],k=x[1],A=0===g.length?null:g[g.length-1],C=G()?"won":F()?"draw":"ongoing",M=b?"waiting":null!==h?"forfeit":C,R="forfeit"===M?1-h:"won"!==M?null:g[g.length-1].player,N=J(),I=B(),S=U([w,N,I],["player","isHighlight","colIsOpen"]),T="ongoing"!==M?null:0===g.length?a:1-g[g.length-1].player;function E(t){for(var n=0;n<e;n++)if(null===w[n][t])return n;return null}function F(){for(var n=0;n<t;n++)if(null===w[e-1][n])return!1;return!0}function G(){if(g.length<2*n-1)return!1;for(var e=g[g.length-1],t=e.player,r=e.row,o=e.col,c=0;c<W.length;c++)for(var a=Object(i.a)(W[c],2),s=a[0],u=a[1],l=-3;l<1;l++)if(Z(t,r+l*s,o+l*u,s,u))return!0;return!1}function J(){var r=H(e,t,!1);if(g.length<2*n-1)return r;for(var o=g[g.length-1],c=o.player,a=o.row,s=o.col,u=0;u<W.length;u++)for(var l=Object(i.a)(W[u],2),b=l[0],d=l[1],j=1-n;j<1;j++)if(Z(c,a+j*b,s+j*d,b,d))for(var p=j;p<j+n;p++)r[a+p*b][s+p*d]=!0;return r}function B(){for(var n=H(e,t),r=0;r<t;r++)for(var o=null===w[e-1][r],c=0;c<e;c++)n[c][r]=o;return n}function Z(r,o,c,a,s){for(var i=0;i<n;i++){var u=o+i*a,l=c+i*s;if(0>u||u>=e||0>l||l>=t||w[u][l]!==r)return!1}return!0}function D(){d(!0),f(null),s(null),v({type:"reset"}),k({type:"reset",rows:e,cols:t})}function P(n){f(null),v({type:"reset"}),k({type:"reset",rows:e,cols:t}),s((function(e){var t=Math.floor(2*Math.random());if(null===e)return 0===n?0:1===n?1:t;switch(n){case"alternate":return 1-e;case"winner":return null!==R?R:e;case"loser":return null!==R?1-R:e;case"random":return t;case 0:return 0;case 1:return 1;default:return console.error("Couldn't select first player.",n),0}})),d(!1)}function Q(e,t){var n=E(e);"ongoing"===M&&t===T&&null!==n&&(v({type:"addMove",player:t,row:n,col:e}),k({type:"placePiece",player:t,row:n,col:e}))}return{board:S,gameStatus:M,prevMove:A,toPlayFirst:a,toPlayNext:T,winner:R,resetGame:D,startGame:P,placePiece:Q,setForfeiter:f}}var V=n.p+"static/media/water_dropwav-6707.104e70a9.mp3",X=n.p+"static/media/good-6081.4c04bbc5.mp3",z=n.p+"static/media/failure-drum-sound-effect-2mp3-7184.7b134939.mp3",K=n.p+"static/media/mixkit-retro-game-notification-212.b222ebf0.wav";function q(e,t,n,o){var c=Object(r.useContext)(Ce).setSoundToPlay;Object(r.useEffect)((function(){0===o?c(X):1===o&&c(e?X:z)}),[o,c,e]),Object(r.useEffect)((function(){"draw"===t&&c(K)}),[t,c]),Object(r.useEffect)((function(){0!==n||e||c(V)}),[n,c,e])}var _=n.p+"static/media/success-1-6297.fd2c2fea.mp3",$=n.p+"static/media/chime-sound-7143.09264db5.mp3",ee=n.p+"static/media/notification-sound-7062.d73a4897.mp3",te=n.p+"static/media/fist-punch-or-kick-7171.1d430a44.mp3",ne=n.p+"static/media/power-down-7103.2164432c.mp3";function re(e,t){if("reset"===t.type)return oe;var n=Object(s.a)({},e);return n[t.type+"s"]+=1,n}var oe={wins:0,draws:0,loses:0};function ce(e,t){var n=Object(r.useReducer)(re,oe),o=Object(i.a)(n,2),c=o[0],a=o[1];return Object(r.useEffect)((function(){0===t?a({type:"win"}):1===t&&a({type:"lose"})}),[t]),Object(r.useEffect)((function(){"draw"===e&&a({type:"draw"})}),[e]),{resultHistory:c,resetResults:Object(r.useCallback)((function(){a({type:"reset"})}),[])}}function ae(e,t){var n=Object(P.a)(e);switch(t.type){case"add":n.push(t.message);break;case"remove":n.shift();break;default:console.error("No match for reduceMessageQueue.",t)}return n}function se(e,t,n,o,c,a,u,l,b){var d=null!==c,j=Q(),p=j.board,h=j.gameStatus,f=j.prevMove,m=j.toPlayFirst,O=j.toPlayNext,g=j.winner,v=j.resetGame,w=j.startGame,k=j.placePiece,A=j.setForfeiter;q(!1,h,O,g);var C=function(e,t){var n=Object(r.useContext)(Ce).setSoundToPlay;return Object(r.useEffect)((function(){e&&n(t?$:ee)}),[n,e,t]),Object(r.useEffect)((function(){return n(e?_:X),function(){n(e?ne:ee)}}),[n,e]),{playKickSound:function(){n(te)}}}(o,d),M=C.playKickSound;!function(e,t,n,o,c,a,i,u,l,b){var d=Object(r.useCallback)(function(){var r=Object(x.a)(y.a.mark((function r(o){return y.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.publish({message:Object(s.a)(Object(s.a)({},o),{},{uuid:n.uuid}),channel:t});case 3:r.next=9;break;case 5:r.prev=5,r.t0=r.catch(0),console.error("Couldn't publish message.",r.t0),alert("Could not send '"+o.type+"' message to opponent.\nYou may be out of sync with your opponent.\nConsider closing the room and creating a new one, if you haven't already.");case 9:case"end":return r.stop()}}),r,null,[[0,5]])})));return function(e){return r.apply(this,arguments)}}(),[e,t,n.uuid]);Object(r.useEffect)((function(){!c&&o||d({type:"playerInfo",name:n.name,colour:n.colour})}),[d,o,c,n.name,n.colour]),Object(r.useEffect)((function(){o&&c&&d({type:"restartMethod",restartMethod:b})}),[d,o,c,b]),Object(r.useEffect)((function(){o&&"ongoing"===a&&d({type:"start",toPlayFirst:u})}),[d,o,a,u]),Object(r.useEffect)((function(){i&&0===i.player&&d({type:"move",col:i.col})}),[d,i]),Object(r.useEffect)((function(){"forfeit"===a&&1===l&&d({type:"forfeit"})}),[d,a,l]),Object(r.useEffect)((function(){o&&!c&&d({type:"kick"})}),[d,o,c]),Object(r.useEffect)((function(){return function(){d({type:o?"close":"leave"})}}),[o,d])}(e,t,n,o,d,h,f,m,g,u);var R=ce(h,g),N=R.resultHistory,I=R.resetResults,S=Object(r.useReducer)(ae,[]),T=Object(i.a)(S,2),E=T[0],F=T[1],G=Object(r.useCallback)((function(e){F({type:"add",message:e})}),[]);function J(){a(null),v()}return Object(r.useEffect)((function(){d||I()}),[d,I]),Object(r.useEffect)((function(){E.length>0&&(E[0].uuid!==n.uuid&&function(e){switch(e.type){case"restartMethod":l(e.restartMethod);break;case"playerInfo":a((function(t){return{name:e.name||t.name,colour:e.colour||t.colour}}));break;case"start":w(1-e.toPlayFirst);break;case"move":k(e.col,1);break;case"forfeit":A(1);break;case"kick":alert("The owner of the room kicked you out."),b();break;case"close":alert("The owner of the room left and so the room has closed."),b();break;case"leave":d&&(alert("Your opponent left."),J());break;default:console.error("Unhandled message.",e)}}(E[0]),F({type:"remove"}))})),{resultHistory:N,board:p,gameStatus:h,winner:g,toPlayNext:O,startNewGame:function(){w(u)},makeMove:function(e){0===O&&k(e,0)},forfeit:function(){A(0)},kickOpponent:function(){J(),M()},queueIncomingMessage:G}}var ie=function(e){var t=e.roomCode,n=e.player,o=e.isOwner,c=e.opponent,a=e.setOpponent,s=e.restartMethod,i=e.setRestartMethod,u=e.unmountRoom,l=e.pubnub,d=se(l,t,n,o,c,a,s,i,u),j=d.resultHistory,p=d.board,h=d.gameStatus,f=d.winner,m=d.toPlayNext,O=d.startNewGame,g=d.makeMove,v=d.forfeit,y=d.kickOpponent,x=d.queueIncomingMessage;return Object(r.useEffect)((function(){return l.subscribe({channels:[t],withPresence:!0}),function(){l.unsubscribe({channels:[t]})}}),[l,t,u]),Object(r.useEffect)((function(){var e={message:function(e){x(e.message)}};return l.addListener(e),function(){l.removeListener(e)}}),[l,x,u]),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(G,{roomCode:t,isOwner:o,hasOpponent:null!==c,restartMethod:s,resultHistory:j,kickOpponent:y,closeRoom:u,leaveRoom:u}),c&&Object(b.jsx)(Z,{viewer:0,board:p,isViewersTurn:0===m,colours:[n.colour,c.colour],makeMove:g}),c&&Object(b.jsx)(D,{viewer:0,isOwner:o,gameStatus:h,winner:f,toPlayNext:m,forfeit:v,startNewGame:O,hasChoice:!1})]})};var ue=function(e){var t=e.resultHistory,n=e.names,r=e.unmountLocal;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("p",{children:"You're playing locally with a friend on the same screen."}),Object(b.jsx)("button",{onClick:r,children:"Return to Lobby"}),Object(b.jsx)(F,{resultHistory:t,headings:[n[0]+" Wins","Draws",n[1]+" Wins"]})]})};var le=function(e){var t=e.names,n=e.gameStatus,r=e.winner,o=e.toPlayNext,c=e.forfeit,a=e.startNewGame;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("p",{children:function(){switch(n){case"won":return"Congratulations "+t[r]+", you won!";case"forfeit":return t[1-r]+" forfeit the game -- "+t[r]+" wins.";case"draw":return"It's a draw.";case"ongoing":return"It's "+t[o]+"'s turn to drop a piece.";case"waiting":return"The game has not started yet.";default:return console.error("Error: ",n),"Something has gone wrong. Apologies."}}()}),"ongoing"===n?Object(b.jsx)("button",{onClick:function(){return c(o)},children:"Forfeit"}):Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("button",{onClick:function(){return a(0)},children:["New Game: ",t[0]," starts"]}),Object(b.jsxs)("button",{onClick:function(){return a(1)},children:["New Game: ",t[1]," starts"]})]})]})};var be=function(e){var t=e.player,n=e.opponent,r=e.unmountLocal,o=Q(),c=o.board,a=o.gameStatus,s=o.toPlayNext,i=o.winner,u=o.startGame,l=o.placePiece,d=o.setForfeiter;q(!0,a,s,i);var j=ce(a,i).resultHistory;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(ue,{resultHistory:j,names:[t.name,n.name],unmountLocal:r}),Object(b.jsx)(Z,{viewer:s,board:c,isViewersTurn:null!==s,colours:[t.colour,n.colour],makeMove:function(e){l(e,s)}}),Object(b.jsx)(le,{names:[t.name,n.name],gameStatus:a,winner:i,toPlayNext:s,forfeit:d,startNewGame:u})]})};var de=function(e){var t=e.resultHistory,n=e.unmountComputer;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("p",{children:"You're playing against the computer."}),Object(b.jsx)("button",{onClick:n,children:"Return to Lobby"}),Object(b.jsx)(F,{resultHistory:t,headings:["Wins","Draws","Loses"]})]})};var je=function(e){var t=e.player,n=e.opponent,r=e.unmountComputer,o=Q(),c=o.board,a=o.gameStatus,s=o.toPlayNext,i=o.winner,u=o.startGame,l=o.placePiece,d=o.setForfeiter;q(!1,a,s,i);var j=ce(a,i).resultHistory;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(de,{resultHistory:j,unmountComputer:r}),Object(b.jsx)(Z,{viewer:0,board:c,isViewersTurn:0===s,colours:[t.colour,n.colour],makeMove:function(e){l(e,0)}}),"TEMP: computer player doesn't exist yet",Object(b.jsx)(D,{viewer:0,isOwner:!0,gameStatus:a,winner:i,toPlayNext:s,forfeit:function(e){d(0)},startNewGame:u,hasChoice:!0})]})},pe=(n(28),n.p+"static/media/website-logo.2a15d8d0.svg");function he(e){var t=e.url,n=e.image,r=e.description;return Object(b.jsxs)("a",{href:t,className:"link-tooltip-container",target:"_blank",rel:"noopener noreferrer",children:[Object(b.jsx)("img",{className:"link-image",src:n,alt:""}),Object(b.jsx)("span",{className:"link-tooltip",children:r})]})}var fe,me=function(e){var t=e.gitHubLink,n=e.themeType,r=[["Personal Website","https://kr-matthews.github.io/",pe],["Project Repository",t,"light"===(void 0===n?"light":n)?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNTE3OEEyQTk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNTE3OEEyQjk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTI4OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTI5OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+m4QGuQAAAyRJREFUeNrEl21ojWEYx895TDPbMNlBK46IUiNmPvHBSUjaqc0H8pF5+aDUKPEBqU2NhRQpX5Rv5jWlDIWlMCv7MMSWsWwmb3tpXub4XXWdPHvc9/Gc41nu+nedc7/8r/99PffLdYdDPsvkwsgkTBwsA/PADJCnzX2gHTwBt8Hl7p537/3whn04XoDZDcpBlk+9P8AFcAghzRkJwPF4zGGw0Y9QS0mAM2AnQj77FqCzrtcwB1Hk81SYojHK4DyGuQ6mhIIrBWB9Xm7ug/6B/nZrBHBegrkFxoVGpnwBMSLR9EcEcC4qb8pP14BWcBcUgewMnF3T34VqhWMFkThLJAalwnENOAKiHpJq1FZgI2AT6HZtuxZwR9GidSHtI30jOrbawxlVX78/AbNfhHlomEUJJI89O2MqeE79T8/nk8nMBm/dK576hZgmA3cp/R4l9/UeSxiHLVIlNm4nFfT0bxyuIj7LHRTKai+zdJobwMKzcZSJb0ePV5PKN+BqAAKE47UlMnERELMM3EdYP/yrd+XYb2mOiYBiQ8OQnoRBlXrl9JZix7D1pHTazu4MoyBcnYamqAjIMTR8G4FT8LuhLsexXYYjICBiqhQBvYb6fLZIJCjPypVvaOoVAW2WcasCnL2Nq82xHJNSqlCeFcDshaPK0twkAhosjZL31QYw+1rlMpWGMArl23SBsZZO58F2tlJXmjOXS+s4WGvpMiBJT/I2PInZ6lIs9/hBsNS1hS6BG0DSqmYEDRlCXQrmy50P1oDRKTSegmNbUsA0zDMwRhPJXeCE3vWLPQMvan6X8AgIa1vcR4AkGZkDR4ejJ1UHpsaVI0g2LInpOsNFUud1rhxSV+fzC9Woz2EZkWQuja7/B+jUrgtIMpy9YCW4n4K41YfzRneW5E1KJTe4B2Zq1Q5EHEtj4U3AfEzR5SVY4l7QYQPJdN2as7RKBF0BPZqqH4VgMAMBL8Byxr7y8zCZiDlnOcEKIPmUpgB5Z2ww5RdOiiRiNajUmWda5IG6WbhsyY2fx6m8gLcoJDJFkH219M3We1+cnda93pfycZpIJEL/s/wSYADmOAwAQgdpBAAAAABJRU5ErkJggg==":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RERCMUIwOUY4NkNFMTFFM0FBNTJFRTMzNTJEMUJDNDYiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RERCMUIwOUU4NkNFMTFFM0FBNTJFRTMzNTJEMUJDNDYiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTJBOTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTJCOTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+jUqS1wAAApVJREFUeNq0l89rE1EQx3e3gVJoSPzZeNEWPKgHoa0HBak0iHiy/4C3WvDmoZ56qJ7txVsPQu8qlqqHIhRKJZceesmhioQEfxTEtsoSpdJg1u/ABJ7Pmc1m8zLwgWTmzcw3L+/te+tHUeQltONgCkyCi2AEDHLsJ6iBMlgHL8FeoqokoA2j4CloRMmtwTmj7erHBXPgCWhG6a3JNXKdCiDl1cidVbXZkJoXQRi5t5BrxwoY71FzU8S4JuAIqFkJ2+BFSlEh525b/hr3+k/AklDkNsf6wTT4yv46KIMNpsy+iMdMc47HNWxbsgVcUn7FmLAzzoFAWDsBx+wVP6bUpp5ewI+DOeUx0Wd9D8F70BTGNjkWtqnhmT1JQAHcUgZd8Lo3rQb1LAT8eJVUfgGvHQigGp+V2Z0iAUUl8QH47kAA1XioxIo+bRN8OG8F/oBjwv+Z1nJgX5jpdzQDw0LCjsPmrcW7I/iHScCAEDj03FtD8A0EyuChHgg4KTlJQF3wZ7WELppnBX+dBFSVpJsOBWi1qiRgSwnOgoyD5hmuJdkWCVhTgnTvW3AgYIFrSbZGh0UW/Io5Vp+DQoK7o80pztWMemZbgxeNwCNwDbw1fIfgGZjhU6xPaJgBV8BdsMw5cbZoHsenwYFxkZzl83xTSKTiviCAfCsJLysH3POfC8m8NegyGAGfLP/VmGmfSChgXroR0RSWjEFv2J/nG84cuKFMf4sTCZqXuJd4KaXFVjEG3+tw4eXbNK/YC9oXXs3O8NY8y99L4BXY5cvLY/Bb2VZ58EOJVcB18DHJq9lRsKr8inyKGVjlmh29mtHs3AHfuhCwy1vXT/Nu2GKQt+UHsGdctyX6eQyNvc+5sfX9Dl7Pe2J/BRgAl2CpwmrsHR0AAAAASUVORK5CYII="]];return Object(b.jsx)("div",{className:"link-footer",children:r.map((function(e){var t=Object(i.a)(e,3),n=t[0],r=t[1],o=t[2];return Object(b.jsx)(he,{description:n,url:r,image:o},r)}))})},Oe=n(15),ge=n(16),ve=Object(ge.a)(fe||(fe=Object(Oe.a)(["\n  body {\n      background: ",";\n      color: ",";\n      transition: all 0.75s ease-in;\n      transition-property: background, color\n    }\n  "])),(function(e){return e.theme.background}),(function(e){return e.theme.foreground}));function ye(e,t){var n=JSON.parse(localStorage.getItem(e)),o=Object(r.useState)(null===n?t:n),c=Object(i.a)(o,2),a=c[0],s=c[1];function u(t){s(t),localStorage.setItem(e,JSON.stringify(t))}return null===n&&u(a),[a,u]}function xe(e){var t=Object(r.useState)(null),n=Object(i.a)(t,2),o=n[0],c=n[1];return Object(r.useEffect)((function(){o&&e&&new Audio(o).play(),c(null)}),[o,e]),{setSoundToPlay:c}}var we={light:{type:"light",background:"#F5F5F5",foreground:"#121212"},dark:{type:"dark",background:"#121212",foreground:"#F5F5F5"}},ke=Object(r.createContext)("all"),Ae=Object(r.createContext)(we.light),Ce=Object(r.createContext)();var Me=function(){var e=ye("theme",we.light),t=Object(i.a)(e,2),n=t[0],o=t[1],c=ye("gradients","all"),a=Object(i.a)(c,2),u=a[0],v=a[1],y=ye("sound",!0),x=Object(i.a)(y,2),w=x[0],k=x[1],A=xe(w).setSoundToPlay,C=ye("name","Nameless"),M=Object(i.a)(C,2),N=M[0],I=M[1],S=ye("colour",R()),T=Object(i.a)(S,2),F=T[0],G=T[1],J=Object(r.useState)(null),B=Object(i.a)(J,2),Z=B[0],D=B[1];function P(e,t){D((function(n){if(n){var r=Object(s.a)({},n);return r[e]=t,r}}))}var W=Object(r.useState)(null),H=Object(i.a)(W,2),U=H[0],Y=H[1],L=Object(r.useCallback)((function(){Y(null),D(null),z(null),$(null),re(null)}),[]),Q=Object(r.useState)(null),V=Object(i.a)(Q,2),X=V[0],z=V[1],K=Object(r.useState)(null),q=Object(i.a)(K,2),_=q[0],$=q[1],ee=Object(r.useState)(null),te=Object(i.a)(ee,2),ne=te[0],re=te[1],oe=ye("uuid",function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",t="",n=0;n<64;n++)t+=e[Math.floor(Math.random()*e.length)];return t}()),ce=Object(i.a)(oe,1)[0],ae=Object(r.useMemo)((function(){return new l.a({publishKey:"pub-c-444b80e2-3dd6-4998-ba4d-fdb8ea2f2d63",subscribeKey:"sub-c-d1ada3dc-38d4-11ec-8182-fea14ba1eb2b",uuid:ce})}),[ce]);return Object(b.jsx)(ke.Provider,{value:u,children:Object(b.jsx)(Ae.Provider,{value:n,children:Object(b.jsxs)(Ce.Provider,{value:{setSoundToPlay:A},children:[Object(b.jsx)(ve,{theme:n}),Object(b.jsx)("h1",{children:"Connect 4"}),Object(b.jsxs)(d,{children:[Object(b.jsxs)(j,{self:!0,children:[Object(b.jsx)(p,{editable:!0,name:N,setName:I}),Object(b.jsx)(h,{editable:!0,colour:F,setColour:G})]}),Object(b.jsxs)(f,{children:[Object(b.jsx)(m,{usingGradient:u,setUsingGradient:v}),Object(b.jsx)(O,{themeType:n.type,toggleTheme:function(){o("light"===n.type?we.dark:we.light)}}),Object(b.jsx)(g,{soundIsOn:w,toggleSound:function(){k(!w)}})]}),Z?Object(b.jsxs)(j,{self:!1,children:[Object(b.jsx)(p,{editable:"local"===U,name:Z.name,setName:function(e){return P("name",e)}}),Object(b.jsx)(h,{editable:"local"===U||"computer"===U,colour:Z.colour,setColour:function(e){return P("colour",e)}})]}):Object(b.jsx)(j,{self:!1})]}),"online"===U?Object(b.jsx)(ie,{roomCode:X,player:{name:N,colour:F,uuid:ce},isOwner:_,opponent:Z,setOpponent:D,restartMethod:ne,setRestartMethod:re,unmountRoom:L,pubnub:ae}):"local"===U?Object(b.jsx)(be,{player:{name:N,colour:F},opponent:Z,unmountLocal:L}):"computer"===U?Object(b.jsx)(je,{player:{name:N,colour:F},opponent:Z,unmountComputer:L}):Object(b.jsx)(E,{setOpponent:D,setPlayType:Y,setRoomCode:z,setIsOwner:$,setRestartMethod:re,pubnub:ae}),Object(b.jsx)(me,{gitHubLink:"https://github.com/kr-matthews/connect-4",themeType:n.type})]})})})};n(33);a.a.render(Object(b.jsx)(o.a.StrictMode,{children:Object(b.jsx)(Me,{})}),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.e07ba274.chunk.js.map