(this["webpackJsonpconnect-4"]=this["webpackJsonpconnect-4"]||[]).push([[0],{25:function(e,t,n){},30:function(e,t,n){},31:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n.n(r),c=n(11),a=n.n(c),l=n(2),i=n(0);var s=function(e){var t=e.children;return Object(i.jsx)("div",{children:t.map((function(e,t){return Object(i.jsx)("div",{children:e},t)}))})};var u=function(e){var t=e.children;return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("h2",{children:"Lobby"}),Object(i.jsx)("p",{children:"Welcome to the Connect 4 lobby. Here, you can create or join a room. Rooms are where you can play a game of Connect 4, and can fit up to 2 players."}),t]})};var d=function(e){var t=e.name,n=e.setName,o=Object(r.useState)(!1),c=Object(l.a)(o,2),a=c[0],s=c[1];function u(){""===t&&n("Nameless"),s(!1)}return Object(i.jsxs)(i.Fragment,{children:["Your name is"," ",a?Object(i.jsx)("input",{autoFocus:!0,type:"text",value:t,placeholder:"Name",onChange:function(e){n(e.target.value.trim())},onKeyDown:function(e){"Enter"===e.key&&u()},onBlur:u}):Object(i.jsx)("button",{onClick:function(){s(!0)},children:t}),"."]})};var j=function(e){var t=e.colour,n=e.setColour;return Object(i.jsxs)(i.Fragment,{children:["Your piece colour is"," ",Object(i.jsx)("input",{type:"color",value:t,onChange:function(e){n(e.target.value)}}),"."]})};var b=function(e){var t=e.themeType,n=e.toggleTheme;return Object(i.jsxs)(i.Fragment,{children:["You're using the ",Object(i.jsx)("button",{onClick:n,children:t})," theme."]})};var h=function(e){var t=e.createRoomHandler,n=Object(r.useState)("alternate"),o=Object(l.a)(n,2),c=o[0],a=o[1];function s(e){a(e.target.value)}return Object(i.jsxs)("div",{children:[Object(i.jsx)("h3",{children:"Create a Room"}),Object(i.jsx)("p",{children:"Once created, you will be given a room code which you can share with a friend to join."}),Object(i.jsx)("p",{children:"The first player of the first game will be selected randomly. Select who will go first in subsequent games."}),Object(i.jsxs)("form",{children:[["Alternate","Loser","Winner","Random"].map((function(e){return Object(i.jsxs)("label",{children:[Object(i.jsx)("input",{type:"radio",value:e.toLowerCase(),checked:c===e.toLowerCase(),onChange:s}),e]},e)})),Object(i.jsx)("button",{onClick:function(e){e.preventDefault(),t(c)},children:"Create"})]})]})};var f=function(e){var t=e.joinRoomHandler,n=Object(r.useState)(""),o=Object(l.a)(n,2),c=o[0],a=o[1];return Object(i.jsxs)("div",{children:[Object(i.jsx)("h3",{children:"Join a Room"}),Object(i.jsx)("p",{children:"If someone else has given you a code, use that code to join their room. Codes are 4 characters."}),Object(i.jsxs)("form",{children:[Object(i.jsx)("input",{type:"text",value:c,placeholder:"enter room code",onChange:function(e){a(e.target.value.toUpperCase().trim())}}),Object(i.jsx)("button",{onClick:function(e){e.preventDefault(),t(c)},children:"Join"})]})]})},O=n(6),p=n.n(O),g=n(12);var m=function(e){var t=e.roomCode,n=e.isOwner,r=e.opponent,o=e.restartMethod,c=e.resultHistory,a=e.kickOpponentHandler,l=e.closeRoomHandler,s=e.leaveRoomHandler,u="random"===o?"The first player of a new game is selected randomly.":"alternate"===o?"Players alternate playing first in a new game.":"The "+o+" of a game will go first for the next game. In the event of a draw, the same player will go first.",d=function(){var e=Object(g.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.clipboard.writeText(t);case 2:alert("Text copied to clipboard.");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(i.jsxs)(i.Fragment,{children:[r?Object(i.jsxs)("div",{children:["You are playing against"," ",Object(i.jsx)("span",{style:{color:r.colour},children:r.name}),"."]}):Object(i.jsx)("div",{children:"Waiting for an opponent to join the room."}),n?Object(i.jsx)("div",{children:"You created and are in control of this room."}):Object(i.jsxs)("div",{children:["You are in ",r.name,"'s room. They have control of the room."]}),Object(i.jsxs)("div",{children:["The room code is ",Object(i.jsx)("button",{onClick:d,children:t}),"."]}),Object(i.jsx)("div",{children:u}),r&&Object(i.jsxs)("div",{children:[Object(i.jsxs)("span",{children:["Wins: ",c.wins]}),Object(i.jsxs)("span",{children:["Draws: ",c.draws]}),Object(i.jsxs)("span",{children:["Loses: ",c.loses]})]}),Object(i.jsxs)("div",{children:[n?Object(i.jsx)("button",{onClick:l,children:"Close Room"}):Object(i.jsx)("button",{onClick:s,children:"Leave Room"}),n&&r&&Object(i.jsx)("button",{onClick:a,children:"Kick Opponent"})]})]})};var v=function(e){var t=e.children;return Object(i.jsx)(i.Fragment,{children:t})};n(25);function w(e){var t=e.row,n=(e.viewer,e.isViewersTurn),r=e.moveHandler,o=e.colours,c=t.map((function(e,t){var c=e.player,a=e.isHighlight,l=e.colIsOpen;return Object(i.jsx)(x,{clickHandler:function(){return r(t)},colour:o[c],isHighlight:a,isClickable:n&&l},t)}));return Object(i.jsx)("tr",{children:c})}function x(e){var t=e.clickHandler,n=e.colour,o=e.isHighlight,c=e.isClickable,a=Object(r.useContext)(K),l=a.background,s=n||l,u={backgroundColor:s,borderColor:o?l:s},d=c?"clickable cell":"cell",j={borderColor:a.foreground};return Object(i.jsx)("td",{className:d,style:j,onClick:t,children:Object(i.jsx)("span",{className:"piece",style:u})})}var y=function(e){for(var t=e.viewer,n=e.board,o=e.isViewersTurn,c=e.colours,a=e.moveHandler,l=Object(r.useContext)(K).foreground,s=[],u=n.length-1;u>-1;u--)s.push(Object(i.jsx)(w,{row:n[u],viewer:t,isViewersTurn:o,moveHandler:a,colours:c},u));return Object(i.jsx)("table",{className:"board",style:{backgroundColor:l},children:Object(i.jsx)("tbody",{children:s})})};var k=function(e){var t=e.viewer,n=e.isOwner,r=e.gameStatus,o=e.winner,c=e.toPlayNext,a=e.forfeitHandler,l=e.newGameHandler;return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("p",{children:function(){switch(r){case"won":return o===t?"Congratulations, you won!":"You lost.";case"forfeit":return o===t?"Your opponent has forfeit the game -- you win.":"You lost by forfeiting the game.";case"draw":return"It's a draw.";case"ongoing":return t===c?"It's your turn to drop a piece.":"Waiting for your opponent to play.";default:return"Something has gone wrong. Apologies."}}()}),"ongoing"===r?Object(i.jsx)("button",{onClick:function(){return a(t)},children:"Forfeit"}):n&&Object(i.jsx)("button",{onClick:l,children:"New Game"})]})},H=n(18),C=n(9),R=[[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]];function S(e,t,n){for(var r=[],o=0;o<e;o++){for(var c=[],a=0;a<t;a++)c.push("empty"===n?{}:n);r.push(c)}return r}function N(e,t){for(var n=e.length,r=[e[0].length,e[0][0].length],o=r[0],c=r[1],a=S(o,c,"empty"),l=0;l<o;l++)for(var i=0;i<c;i++){a[l][i]={};for(var s=0;s<n;s++)a[l][i][t[s]]=e[s][l][i]}return a}function F(e,t){var n=Object(C.a)(e);switch(t.type){case"reset":return[];case"addMove":var r=t.player,o=t.row,c=t.col;return n.push({player:r,row:o,col:c}),n;case"undo":return e===[]?e:(n.pop(),n);default:return console.log("moveHistoryReducer switch didn't match any case"),e}}function T(e,t){var n=Object(C.a)(e);switch(t.type){case"reset":return S(t.rows,t.cols,null);case"placePiece":return n[t.row][t.col]=t.player,n;case"undo":return n[t.row][t.col]=null,n;default:return console.log("peicesReducer switch didn't match any case"),e}}function P(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:7,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,c=Object(r.useState)(e),a=Object(l.a)(c,2),i=a[0],s=a[1],u=Object(r.useState)(null),d=Object(l.a)(u,2),j=d[0],b=d[1],h=Object(r.useReducer)(F,[]),f=Object(l.a)(h,2),O=f[0],p=f[1],g=Object(r.useReducer)(T,S(t,n,null)),m=Object(l.a)(g,2),v=m[0],w=m[1],x=G()?"won":Y()?"draw":"ongoing",y=null!==j?"forfeit":x,k="forfeit"===y?1-j:"won"!==y?null:O[O.length-1].player,H=E(),C=J(),P=N([v,H,C],["player","isHighlight","colIsOpen"]),M="ongoing"!==y?null:0===O.length?i:1-O[O.length-1].player;function I(e){for(var n=0;n<t;n++)if(null===v[n][e])return n;return null}function Y(){for(var e=0;e<n;e++)if(null===v[t-1][e])return!1;return!0}function G(){if(O.length<2*o-1)return!1;for(var e=O[O.length-1],t=e.player,n=e.row,r=e.col,c=0;c<R.length;c++)for(var a=Object(l.a)(R[c],2),i=a[0],s=a[1],u=-3;u<1;u++)if(L(t,n+u*i,r+u*s,i,s))return!0;return!1}function E(){var e=S(t,n,!1);if(O.length<2*o-1)return e;for(var r=O[O.length-1],c=r.player,a=r.row,i=r.col,s=0;s<R.length;s++)for(var u=Object(l.a)(R[s],2),d=u[0],j=u[1],b=1-o;b<1;b++)if(L(c,a+b*d,i+b*j,d,j))for(var h=b;h<b+o;h++)e[a+h*d][i+h*j]=!0;return e}function J(){for(var e=S(t,n),r=0;r<n;r++)for(var o=null===v[t-1][r],c=0;c<t;c++)e[c][r]=o;return e}function L(e,r,c,a,l){for(var i=0;i<o;i++){var s=r+i*a,u=c+i*l;if(0>s||s>=t||0>u||u>=n||v[s][u]!==e)return!1}return!0}function W(e){s(e),b(null),p({type:"reset"}),w({type:"reset",rows:t,cols:n})}function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M,n=I(e);"ongoing"===y&&t===M&&null!==n&&(p({type:"addMove",player:t,row:n,col:e}),w({type:"placePiece",player:t,row:n,col:e}))}function K(e){b(e)}return{board:P,gameStatus:y,toPlayNext:M,winner:k,resetGame:W,placePiece:D,forfeit:K}}function M(e,t){if("reset"===t.type)return I;var n=Object(H.a)({},e);return n[t.type+"s"]+=1,n}var I={wins:0,draws:0,loses:0};var Y=function(e){var t=e.player,n=e.isOwner,o=e.roomCode,c=e.restartMethod,a=e.closeRoomHandler,s=e.leaveRoomHandler,u=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.floor(2*Math.random()),n=Object(r.useState)({name:"Bob",colour:"red"}),o=Object(l.a)(n,2),c=o[0],a=o[1],i=null===c?1:2,s=Object(r.useReducer)(M,I),u=Object(l.a)(s,2),d=u[0],j=u[1],b=P(t),h=b.board,f=b.gameStatus,O=b.toPlayNext,p=b.winner,g=b.resetGame,m=b.placePiece,v=b.forfeit,w=Object(r.useState)(t),x=Object(l.a)(w,2),y=x[0],k=x[1];function H(t){var n=null;switch(e){case"random":n=Math.floor(2*Math.random());break;case"alternate":n=1-y;break;case"loser":n="draw"===t?y:1-p;break;case"winner":n="draw"===t?y:p;break;default:console.log("New Game click handler didn't match any case."),n=0}g(n),k(n)}function C(){a(null)}return Object(r.useEffect)((function(){switch(f){case"won":case"forfeit":0===p&&j({type:"win"}),0===p&&console.log("win sound"),1===p&&j({type:"lose"}),1===p&&console.log("lose sound");break;case"draw":j({type:"draw"}),console.log("draw sound")}}),[f,p]),Object(r.useEffect)((function(){1===i&&j({type:"reset"})}),[i]),Object(r.useEffect)((function(){1===i?console.log("Opponent left sound"):console.log("Opponent joined sound")}),[i]),Object(r.useEffect)((function(){0===O&&console.log("Your turn sound")}),[O]),{opponent:c,resultHistory:d,board:h,gameStatus:f,winner:p,toPlayNext:O,moveHandler:m,forfeitHandler:v,newGameHandler:H,kickOpponentHandler:C}}(c),d=u.opponent,j=u.resultHistory,b=u.board,h=u.gameStatus,f=u.winner,O=u.toPlayNext,p=u.moveHandler,g=u.forfeitHandler,w=u.newGameHandler,x=u.kickOpponentHandler;return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)("h2",{children:"Room"}),Object(i.jsx)(m,{roomCode:o,isOwner:n,opponent:d,restartMethod:c,resultHistory:j,kickOpponentHandler:x,closeRoomHandler:a,leaveRoomHandler:s}),d&&Object(i.jsxs)(v,{children:[Object(i.jsx)(y,{viewer:0,board:b,isViewersTurn:0===O,colours:[t.colour,d.colour],moveHandler:p}),Object(i.jsx)(k,{viewer:0,isOwner:n,gameStatus:h,winner:f,toPlayNext:O,forfeitHandler:g,newGameHandler:w})]})]})};function G(e,t){var n=JSON.parse(localStorage.getItem(e)),o=Object(r.useState)(n||t),c=Object(l.a)(o,2),a=c[0],i=c[1];return[a,function(t){i(t),localStorage.setItem(e,JSON.stringify(t))}]}var E,J=n(13),L=n(14),W=Object(L.a)(E||(E=Object(J.a)(["\n  body {\n      background: ",";\n      color: ",";\n      transition: all 0.75s ease-in;\n      transition-property: background, color\n    }\n  "])),(function(e){return e.theme.background}),(function(e){return e.theme.foreground})),D={light:{type:"light",background:"#F5F5F5",foreground:"#121212"},dark:{type:"dark",background:"#121212",foreground:"#F5F5F5"}},K=Object(r.createContext)(D.light);var V=function(){var e=G("name","Nameless"),t=Object(l.a)(e,2),n=t[0],o=t[1],c=G("colour","#0000FF"),a=Object(l.a)(c,2),O=a[0],p=a[1],g=G("theme",D.light),m=Object(l.a)(g,2),v=m[0],w=m[1],x=Object(r.useState)(null),y=Object(l.a)(x,2),k=y[0],H=y[1],C=Object(r.useState)(null),R=Object(l.a)(C,2),S=R[0],N=R[1],F=Object(r.useState)("alternate"),T=Object(l.a)(F,2),P=T[0],M=T[1];return Object(i.jsxs)(K.Provider,{value:v,children:[Object(i.jsx)(W,{theme:v}),Object(i.jsxs)(s,{children:[Object(i.jsx)(d,{name:n,setName:o}),Object(i.jsx)(j,{colour:O,setColour:p}),Object(i.jsx)(b,{themeType:v.type,toggleTheme:function(){w("light"===v.type?D.dark:D.light)}})]}),Object(i.jsx)("h1",{children:"Connect 4 [WIP]"}),k?Object(i.jsx)(Y,{player:{name:n,colour:O},isOwner:S,roomCode:k,restartMethod:P,closeRoomHandler:function(){H(null),N(null)},leaveRoomHandler:function(){H(null),N(null),M("alternate")}}):Object(i.jsxs)(u,{children:[Object(i.jsx)(h,{createRoomHandler:function(e){H("KNKT"),N(!0),M(e)}}),Object(i.jsx)(f,{joinRoomHandler:function(e){H(e),N(!1)}})]})]})};n(30);a.a.render(Object(i.jsx)(o.a.StrictMode,{children:Object(i.jsx)(V,{})}),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.a1cfd35f.chunk.js.map